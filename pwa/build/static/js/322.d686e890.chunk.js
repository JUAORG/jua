"use strict";(self.webpackChunkjua_mvp=self.webpackChunkjua_mvp||[]).push([[322],{1322:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Q});var r=s(7051),i=s(5043),n=s(311),a=s(3216),o=s(7965),l=s(5703),d=s(9252),c=s(5865),u=s(1637),x=s(8911),h=s(5795),A=s(2143),p=s(4161),v=s(2110),j=s(8669),m=s(2828),g=s(6591),f=s(1045),b=s(6494),y=s(9135),S=s(2893),w=s(5472),C=s(8565),q=s(4646),_=s(3536),k=s(1081),R=s(5316),D=s(8533),F=s(6600),J=s(9336),P=s(9347),U=s(8977),E=s(889),I=s(710),B=s(6605),O=s(3718),W=s(5721),L=s(681),M=s(3851),T=s(8734),N=s(579);function Z(e){let{user:t,brief:s}=e;return(0,N.jsx)(W.A,{sx:{width:"100%",maxWidth:400,bgcolor:"background.paper"},children:(0,N.jsxs)(L.Ay,{alignItems:"flex-start",children:[(0,N.jsx)(M.A,{children:(0,N.jsx)(f.A,{sx:{color:"#2065D1"},src:(0,_.get)(t,"profile_picture")})}),(0,N.jsx)(T.A,{primary:(0,_.get)(t,"industry"),secondary:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(c.A,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:[(0,_.get)(t,"first_name")," ",!s&&(0,_.get)(t,"last_name")]}),s&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("br",{}),"\u2014 ",(0,_.get)(t,"bio")]})]})})]})})}var H=s(7194),G=s(4327);function z(){return(0,N.jsx)(W.A,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},children:(0,N.jsxs)(L.Ay,{children:[(0,N.jsx)(M.A,{children:(0,N.jsx)(f.A,{children:(0,N.jsx)(G.A,{})})}),(0,N.jsxs)(x.A,{direction:"column",justifyContent:"space-evenly",alignItems:"center",spacing:2,children:[(0,N.jsx)(T.A,{primary:"TBA",secondary:"Jan 9, 2014 - Aug 25, 2017 "}),"some short disc"]})]})})}const V=e=>{let{user:t,handleClose:s}=e;const[r,n]=i.useState(!0),[a,o]=i.useState("paper"),[l,d]=i.useState("panel1"),u=e=>(t,s)=>{d(!!s&&e)},h=i.useRef(null);return i.useEffect((()=>{if(r){const{current:e}=h;null!==e&&e.focus()}}),[r]),(0,N.jsx)("div",{children:(0,N.jsxs)(k.A,{open:!0,onClose:s,scroll:a,children:[(0,N.jsx)(R.A,{dividers:"paper"===a,children:(0,N.jsxs)(D.A,{id:"scroll-dialog-description",ref:h,tabIndex:-1,children:[(0,N.jsx)(F.A,{id:"scroll-dialog-title",children:"Create Service Request"}),(0,N.jsx)(Z,{user:t}),(0,N.jsx)(x.A,{direction:"column",justifyContent:"space-evenly",alignItems:"center",spacing:2,children:(0,N.jsxs)("div",{children:[(0,N.jsx)(J.A,{}),(0,N.jsxs)(E.A,{expanded:"panel1"===l,onChange:u("panel1"),children:[(0,N.jsxs)(B.A,{expandIcon:(0,N.jsx)(O.A,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:[(0,N.jsx)(c.A,{sx:{width:"33%",flexShrink:0},children:"Request"}),(0,N.jsx)(c.A,{sx:{color:"text.secondary"},children:"Advisory Session"})]}),(0,N.jsxs)(I.A,{children:[(0,N.jsxs)(c.A,{mb:3,children:["By requesting the booking, you are agreeing to the Expert's hourly rate of R"," ",(0,_.get)(t,"rate_per_hour_in_rands"),"."]}),(0,N.jsx)(H.A,{serviceProvider:t})]})]}),(0,N.jsx)(J.A,{}),(0,N.jsxs)(E.A,{disabled:!0,expanded:"panel4"===l,onChange:u("panel4"),children:[(0,N.jsx)(B.A,{expandIcon:(0,N.jsx)(O.A,{}),"aria-controls":"panel2bh-content",id:"panel2bh-header",children:(0,N.jsx)(c.A,{sx:{width:"33%",flexShrink:0},children:"Reviews"})}),(0,N.jsx)(I.A,{children:(0,N.jsx)(z,{})})]})]})}),(0,N.jsx)(J.A,{})]})}),(0,N.jsxs)(P.A,{children:[(0,N.jsx)(U.A,{onClick:s,children:"Close"})," |",(0,N.jsx)(U.A,{disabled:!0,children:"Report"})," |",(0,N.jsx)(U.A,{disabled:!0,children:"Request Service Request"})]})]})})};var Y=s(9838);const K=6;function Q(){const[e,t]=(0,i.useState)([]),s=(0,a.Zp)(),[_,k]=(0,i.useState)(""),[R,D]=(0,i.useState)(""),[F,J]=(0,i.useState)(1),[P,U]=(0,i.useState)(null),[E,I]=(0,i.useState)(!1),[B,O]=(0,i.useState)(!0);(0,i.useEffect)((()=>{const e=(0,w.P)((0,w.rJ)(C.db,"users"),(0,w._M)("profile_visible","==",!0),(0,w._M)("is_service_provider","==",!0)),s=(0,w.aQ)(e,(e=>{const s=e.docs.map((e=>(0,r.A)((0,r.A)({},e.data()),{},{ref:e.id})));t(s),O(!1)}),(e=>{q.A.error("Failed to listen to network users","Error"),O(!1)}));return()=>s()}),[]);const W=(0,i.useMemo)((()=>[...new Set(e.map((e=>e.industry)))].sort()),[e]),L=(0,i.useMemo)((()=>{let t=e;return _&&(t=t.filter((e=>e.industry===_))),R&&(t=t.filter((e=>"".concat(e.first_name," ").concat(e.last_name," ").concat(e.bio||"").toLowerCase().includes(R.toLowerCase())))),t}),[e,_,R]),M=(0,i.useMemo)((()=>{const e=(F-1)*K;return L.slice(e,e+K)}),[L,F]);return(0,N.jsx)(Y.A,{title:"Jua Network",children:(0,N.jsxs)(d.A,{maxWidth:"xl",children:[(0,N.jsx)(c.A,{variant:"h4",sx:{mb:5},children:"Jua Network"}),B?(0,N.jsx)(u.A,{sx:{mx:"auto",display:"block"}}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(x.A,{direction:"row",spacing:2,sx:{mb:3},children:[(0,N.jsxs)(h.A,{select:!0,label:"Filter by Industry",value:_,onChange:e=>{k(e.target.value),J(1)},sx:{minWidth:220},children:[(0,N.jsx)(A.A,{value:"",children:"All Industries"}),W.map((e=>(0,N.jsx)(A.A,{value:e,children:e},e)))]}),(0,N.jsx)(h.A,{label:"Search",value:R,onChange:e=>{D(e.target.value),J(1)},placeholder:"Search name or bio...",sx:{flex:1}})]}),(0,N.jsx)(p.A,{sx:{gridAutoFlow:"row",gridTemplateColumns:"repeat(auto-fill,minmax(250px,1fr)) !important"},children:M.map((e=>(0,N.jsx)(v.A,{sx:{width:350,maxWidth:350},onClick:()=>(async e=>{try{const t=await(0,w.x7)((0,w.H9)(C.db,"users",e));t.exists()&&(U((0,r.A)((0,r.A)({},t.data()),{},{ref:t.id})),I(!0),S.Ay.event({value:1,category:"Profile view: ".concat(e),action:"Clicked on service provider profile"}))}catch(t){q.A.error("Could not load user details","Error")}})(e.ref),children:(0,N.jsx)(j.A,{children:(0,N.jsxs)(m.A,{children:[(0,N.jsx)(g.A,{component:"div",sx:{objectFit:"contain",background:"#004aad",height:20}}),(0,N.jsx)(f.A,{src:e.profile_picture,sx:{color:"#2065D1",position:"relative",left:"20px",top:"15px"}}),(0,N.jsxs)(b.A,{children:[(0,N.jsxs)(c.A,{gutterBottom:!0,variant:"h5",children:[e.first_name," ",e.last_name]}),(0,N.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:e.bio})]})]})})},e.ref)))}),L.length>K&&(0,N.jsx)(y.A,{count:Math.ceil(L.length/K),page:F,onChange:(e,t)=>J(t),sx:{mt:4,display:"flex",justifyContent:"center"}})]}),E&&(0,N.jsx)(V,{user:P,handleClose:()=>I(!1)}),(0,N.jsx)(l.A,{actions:[{icon:(0,N.jsx)(n.A,{}),name:"Feedback",onClick:()=>s("/dashboard/about",{replace:!0})},{icon:(0,N.jsx)(o.A,{}),name:"Share",onClick:()=>navigator.share({title:"JUA",text:"Join JUA today!",url:"https://jua.one"})}]})]})})}},5703:(e,t,s)=>{s.d(t,{A:()=>l});s(5043);var r=s(6446),i=s(7500),n=s(2119),a=s(6040),o=s(579);function l(e){let{actions:t,customSpeedDialIcon:s}=e;return(0,o.jsx)(r.A,{sx:{bottom:10,right:10,position:"fixed",transform:"translateZ(0px)",flexGrow:1},children:(0,o.jsx)(i.A,{ariaLabel:"SpeedDial basic example",sx:{position:"absolute",bottom:16,right:16},icon:s||(0,o.jsx)(n.A,{}),children:t.map((e=>(0,o.jsx)(a.A,{onClick:e.onClick,icon:e.icon,tooltipTitle:e.name},e.name)))})})}},7194:(e,t,s)=>{s.d(t,{A:()=>R});var r=s(7051),i=s(5043),n=s(3536),a=s(2893),o=s(6178),l=s.n(o),d=s(4858),c=s(3216),u=s(4194),x=s(8911),h=s(5795),A=s(8977),p=s(1081),v=s(6600),j=s(5316),m=s(8533),g=s(9347),f=s(794),b=s(9870),y=s(1690),S=s(4826),w=s(2812),C=s(5472),q=s(4646),_=s(8565),k=s(579);function R(e){var t;let{closeDialog:s,serviceRequest:o,serviceProvider:R,isServiceProvider:D=!1}=e;(0,c.Zp)();const F=(0,d.mN)({defaultValues:o||{}}),{register:J,setValue:P,handleSubmit:U}=F,[E,I]=(0,i.useState)((0,n.get)(o,"date_and_time")?new Date((0,n.get)(o,"date_and_time")):null),[B,O]=(0,i.useState)(!1),[W,L]=(0,i.useState)(!1),[M,T]=(0,i.useState)(null),[N,Z]=(0,i.useState)("");(0,i.useEffect)((()=>{R&&P("serviceProvider",R.ref||R.id)}),[R,P]);const H="Accepted"===(null===o||void 0===o?void 0:o.status)||"Cancelled"===(null===o||void 0===o?void 0:o.status);return(0,k.jsxs)(k.Fragment,{children:[H&&(0,k.jsxs)(u.A,{severity:"info",sx:{mb:2},children:["This request has been ",(0,k.jsx)("strong",{children:null===o||void 0===o?void 0:o.status}),null!==o&&void 0!==o&&o.reason?" \u2014 ".concat(o.reason):"",(null===o||void 0===o||null===(t=o.statusUpdatedAt)||void 0===t?void 0:t.toDate)&&(0,k.jsxs)(k.Fragment,{children:[" ","on ",(0,k.jsx)("strong",{children:l()(o.statusUpdatedAt.toDate()).format("lll")})]}),(null===o||void 0===o?void 0:o.statusUpdatedBy)&&(0,k.jsxs)(k.Fragment,{children:[" ","by ",(0,k.jsx)("strong",{children:o.statusUpdatedBy===o.customer?"customer":"provider"})]}),"."]}),(0,k.jsx)("form",{onSubmit:U((async e=>{if(!H)try{O(!0),a.Ay.event({value:1,category:"Service Requests",action:o?"Service Request updated":"Service Request created"});const t=_.j.currentUser;if(!t)return void q.A.error("User is not authenticated.","Error");if(!e.serviceProvider)return void q.A.error("Service Provider is required.","Error");if(!E)return void q.A.error("Please select a valid date and time.","Error");const i=E.toDate?E.toDate():E;if(null!==o&&void 0!==o&&o.id){const t=(0,C.H9)(_.db,"serviceRequests",o.id);await(0,C.mZ)(t,(0,r.A)((0,r.A)({},e),{},{date_and_time:i,updatedAt:(0,C.O5)()}))}else{const s=(0,C.rJ)(_.db,"serviceRequests"),n=(await(0,C.gS)(s,(0,r.A)((0,r.A)({},e),{},{date_and_time:i,createdAt:(0,C.O5)(),status:"Pending",customer:t.uid})),(0,C.rJ)(_.db,"users",t.uid,"notifications"));await(0,C.gS)(n,{title:"Service Request Created",message:"Your new service request has been submitted.",type:"service_request",createdAt:(0,C.O5)(),read:!1});const a=(0,C.rJ)(_.db,"users",e.serviceProvider,"notifications");await(0,C.gS)(a,{title:"New Service Request",message:"".concat(t.displayName||"A user"," has sent you a new service request."),type:"service_request",createdAt:(0,C.O5)(),read:!1})}L(!0),null===s||void 0===s||s()}catch(t){q.A.error("Something went wrong while submitting the request.","Error")}finally{O(!1)}})),children:(0,k.jsxs)(x.A,{spacing:3,children:[(0,k.jsx)(h.A,(0,r.A)({fullWidth:!0,required:!0,label:"Subject",disabled:H},J("subject",{required:"Subject is required"}))),(0,k.jsx)(y.$,{dateAdapter:b.A,adapterLocale:"en-za",children:(0,k.jsx)(S.K,{label:"Ideal date and time for service request",required:!0,disabled:H,value:E,onChange:e=>{I(null!==e&&void 0!==e&&e.toDate?e.toDate():e),P("date_and_time",null!==e&&void 0!==e&&e.toDate?e.toDate():e)},renderInput:e=>(0,k.jsx)(h.A,(0,r.A)({},e))})}),(0,k.jsx)(h.A,(0,r.A)({fullWidth:!0,label:"Description (optional)",disabled:H},J("description"))),(0,k.jsx)(w.A,{fullWidth:!0,size:"large",type:"submit",loading:B,variant:"contained",disabled:H,children:null!==o&&void 0!==o&&o.id?"Update Request":"Send Request"}),(null===o||void 0===o?void 0:o.id)&&!H&&(D?(0,k.jsxs)(x.A,{direction:"row",spacing:2,children:[(0,k.jsx)(A.A,{color:"success",variant:"outlined",onClick:()=>T("Accepted"),children:"Approve"}),(0,k.jsx)(A.A,{color:"error",variant:"outlined",onClick:()=>T("Cancelled"),children:"Cancel"})]}):(0,k.jsx)(A.A,{color:"error",variant:"outlined",onClick:()=>T("Cancelled"),children:"Cancel Request"}))]})}),(0,k.jsxs)(p.A,{open:!!M,onClose:()=>T(null),children:[(0,k.jsxs)(v.A,{children:[M," Service Request"]}),(0,k.jsxs)(j.A,{children:[(0,k.jsx)(m.A,{children:"Cancelled"===M?"Please provide a reason for cancelling this request.":"You are about to approve this request."}),"Cancelled"===M&&(0,k.jsx)(h.A,{autoFocus:!0,margin:"dense",label:"Reason",fullWidth:!0,variant:"standard",value:N,onChange:e=>Z(e.target.value)})]}),(0,k.jsxs)(g.A,{children:[(0,k.jsx)(A.A,{onClick:()=>T(null),children:"Close"}),(0,k.jsx)(A.A,{onClick:()=>(async e=>{try{const t=_.j.currentUser,s=(0,C.H9)(_.db,"serviceRequests",o.id);await(0,C.mZ)(s,(0,r.A)((0,r.A)({status:e},N&&{reason:N}),{},{statusUpdatedAt:(0,C.O5)(),statusUpdatedBy:(null===t||void 0===t?void 0:t.uid)||null,updatedAt:(0,C.O5)()}));const i=(0,C.rJ)(_.db,"serviceRequests",o.id,"logs");await(0,C.gS)(i,{action:e,message:N||"Status changed to ".concat(e),performedBy:(null===t||void 0===t?void 0:t.uid)||null,performedAt:(0,C.O5)()});const n="Cancelled"===e?o.serviceProvider:o.customer,a=(0,C.rJ)(_.db,"users",n,"notifications");await(0,C.gS)(a,{title:"Service Request ".concat(e),message:N||"The request was ".concat(e.toLowerCase(),"."),type:"service_request",createdAt:(0,C.O5)(),read:!1}),T(null),Z(""),q.A.success("Request ".concat(e.toLowerCase()," successfully"),"Success")}catch(t){q.A.error("Failed to process the request.","Error")}})(M),variant:"contained",children:"Confirm"})]})]}),(0,k.jsx)(f.A,{open:W,autoHideDuration:4e3,onClose:()=>L(!1),message:"Service request submitted successfully"})]})}},9838:(e,t,s)=>{s.d(t,{A:()=>A});var r=s(7051),i=s(45),n=s(5173),a=s.n(n),o=s(3602),l=s(9490),d=s(5043),c=s(6446),u=s(579);const x=["children","title","showGoBackArrow","meta"],h=(0,d.forwardRef)(((e,t)=>{let{children:s,title:n="",showGoBackArrow:a=!1,meta:d}=e,h=(0,i.A)(e,x);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.mg,{children:[(0,u.jsx)("title",{children:"".concat(n," | JUA")}),d]}),(0,u.jsxs)(c.A,(0,r.A)((0,r.A)({ref:t},h),{},{children:[a&&(0,u.jsx)(o.A,{onClick:()=>window.history.go(-1),sx:{top:40,left:20,cursor:"pointer",position:"relative"}}),s]}))]})}));h.propTypes={children:a().node.isRequired,title:a().string,meta:a().node};const A=h}}]);
//# sourceMappingURL=322.d686e890.chunk.js.map